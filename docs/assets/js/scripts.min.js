"use strict";function addListener(t,e,n){function i(e,t,n){e.split(" ").forEach(function(e){return t.addEventListener(e,n)})}e instanceof NodeList?[].forEach.call(e,function(e){return i(t,e,n)}):i(t,e,n)}function bind(i){var e=qa("[data-id]");[].forEach.call(e,function(e){var t=e.dataset.id,n=i[t];"precio"===t?e.innerHTML=formatAmount(n):"saldo"===t?"false"===n&&setTimeout(function(){showAdvice(e,!0)},500):e.innerHTML=n})}function formatAmount(e){return"$ "+Number(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}function handleDigitKeyup(e){var t=e.target,n=e.keyCode,i=t.parentNode;8===n?(e=i.previousElementSibling)&&((e=q("input",e)).value="",e.focus()):47<n&&n<58&&(""===t.value||(i=i.nextElementSibling)&&q("input",i).focus()),validateCode()}function numberFilter(e){/^\d{0,1}$/.test(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""}function searchToJson(){for(var e,t=location.search.substring(1).split("&"),n={},i=0;i<t.length;i++)""!==t[i]&&(e=t[i].split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return n}function showAdvice(e,t){t?e.classList.remove("no-visible"):e.classList.add("no-visible")}function q(e,t){return(t||document).querySelector(e)}function qa(e,t){return(t||document).querySelectorAll(e)}function validateCode(){var e=q(".auth-screen .code"),t=qa(".auth-screen .digit input"),n="";[].forEach.call(t,function(e){n+=e.value}),6===n.length&&("000001"===n?e.classList.add("valid"):e.classList.add("invalid"))}var advices,digits;!function(d){d.fn.swipe=function(e){var s=d.extend({cb:function(){console.log("swipe done")}},e);return this.each(function(){var t=d(this),n=0,i=0,o=!1,a=t.find(".slider"),c=t.find(".text");a.on("mousedown touchstart",function(e){o=!0,i=t.width()-d(this).width()+10,n=e.clientX||e.originalEvent.touches[0].pageX}),d(document.body,a).on("mouseup touchend",function(e){if(o){if(o=!1,(e.clientX||e.changedTouches[0].pageX)-n<i)return c.fadeTo(300,1),void a.animate({left:"-10px"},300);s.cb()}}),d(document.body).on("mousemove touchmove",function(e){var t;o&&(e=1-(t=(e.clientX||e.originalEvent.touches[0].pageX)-n)/i,c.fadeTo(0,e),t<=0?a.css({left:"-10px"}):i+10<=t?a.css({left:i+"px"}):a.css({left:t-10}))})})}}(jQuery),0<=location.pathname.indexOf("detail")?(advices=qa(".advice.fixed"),[].forEach.call(advices,function(e){addListener("click",q(".close-btn",e),function(){showAdvice(e,!1)})}),$(".swipe-btn").swipe({cb:function(){console.log("swipe from detail")}}),bind(searchToJson())):0<=location.pathname.indexOf("auth")&&(addListener("keypress keydown keyup input change paste",digits=qa(".auth-screen .digit input"),numberFilter),addListener("keyup",digits,handleDigitKeyup),digits[0].focus());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiLCJqcXVlcnkuc3dpcGUuanMiXSwibmFtZXMiOlsiYWRkTGlzdGVuZXIiLCJldmVudHMiLCJlbHMiLCJoYW5kbGVyIiwiYWRkIiwiZWwiLCJzcGxpdCIsImZvckVhY2giLCJldmVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJOb2RlTGlzdCIsImNhbGwiLCJiaW5kIiwidmFsdWVzIiwidGFncyIsInFhIiwidGFnIiwiaWQiLCJkYXRhc2V0IiwidmFsdWUiLCJpbm5lckhUTUwiLCJmb3JtYXRBbW91bnQiLCJzZXRUaW1lb3V0Iiwic2hvd0FkdmljZSIsImFtb3VudCIsIk51bWJlciIsInRvRml4ZWQiLCJyZXBsYWNlIiwiaGFuZGxlRGlnaXRLZXl1cCIsIl9yZWYiLCJ0YXJnZXQiLCJrZXlDb2RlIiwicGFyZW50IiwicGFyZW50Tm9kZSIsInByZXYiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiaW5wdXQiLCJxIiwiZm9jdXMiLCJuZXh0IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidmFsaWRhdGVDb2RlIiwibnVtYmVyRmlsdGVyIiwiZSIsInRlc3QiLCJ0aGlzIiwib2xkVmFsdWUiLCJvbGRTZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvblN0YXJ0Iiwib2xkU2VsZWN0aW9uRW5kIiwic2VsZWN0aW9uRW5kIiwiaGFzT3duUHJvcGVydHkiLCJzZXRTZWxlY3Rpb25SYW5nZSIsInNlYXJjaFRvSnNvbiIsInBhcnRzIiwicGFpcnMiLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsIm9iamVjdCIsImkiLCJsZW5ndGgiLCJkZWNvZGVVUklDb21wb25lbnQiLCJmbGFnIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2VsZWN0b3IiLCJjb250ZXh0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicXVlcnlTZWxlY3RvckFsbCIsImNvZGVFbCIsImRpZ2l0cyIsImNvZGUiLCJkaWdpdCIsImFkdmljZXMiLCIkIiwiZm4iLCJzd2lwZSIsIm9wdGlvbnMiLCJzZXR0aW5ncyIsImV4dGVuZCIsImNiIiwiY29uc29sZSIsImxvZyIsImVhY2giLCIkdGhpcyIsImluaXRpYWxNb3VzZSIsInNsaWRlTW92ZW1lbnRUb3RhbCIsIm1vdXNlSXNEb3duIiwiJHNsaWRlciIsImZpbmQiLCIkdGV4dCIsIm9uIiwid2lkdGgiLCJjbGllbnRYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJwYWdlWCIsImJvZHkiLCJjaGFuZ2VkVG91Y2hlcyIsImZhZGVUbyIsImFuaW1hdGUiLCJsZWZ0IiwicmVsYXRpdmVNb3VzZSIsInNsaWRlUGVyY2VudCIsImNzcyIsImpRdWVyeSIsInBhdGhuYW1lIiwiaW5kZXhPZiIsImFkdmljZSJdLCJtYXBwaW5ncyI6ImFBTUEsU0FBQUEsWUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxTQUFBQyxFQUFBSCxFQUFBSSxFQUFBRixHQUNBRixFQUFBSyxNQUFBLEtBQUFDLFFBQUEsU0FBQUMsR0FBQSxPQUFBSCxFQUFBSSxpQkFBQUQsRUFBQUwsS0FHQUQsYUFBQVEsU0FDQSxHQUFBSCxRQUFBSSxLQUFBVCxFQUFBLFNBQUFHLEdBQUEsT0FBQUQsRUFBQUgsRUFBQUksRUFBQUYsS0FFQUMsRUFBQUgsRUFBQUMsRUFBQUMsR0FRQSxTQUFBUyxLQUFBQyxHQUNBLElBQUFDLEVBQUFDLEdBQUEsYUFFQSxHQUFBUixRQUFBSSxLQUFBRyxFQUFBLFNBQUFFLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsUUFBQSxHQUNBQyxFQUFBTixFQUFBSSxHQUVBLFdBQUFBLEVBQ0FELEVBQUFJLFVBQUFDLGFBQUFGLEdBQ0EsVUFBQUYsRUFDQSxVQUFBRSxHQUNBRyxXQUFBLFdBQUFDLFdBQUFQLEdBQUEsSUFBQSxLQUdBQSxFQUFBSSxVQUFBRCxJQVVBLFNBQUFFLGFBQUFHLEdBQ0EsTUFBQSxLQUFBQyxPQUFBRCxHQUFBRSxRQUFBLEdBQUFDLFFBQUEsd0JBQUEsS0FPQSxTQUFBQyxpQkFBQUMsR0FBQSxJQUFBQyxFQUFBRCxFQUFBQyxPQUFBQyxF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LElBQUEsQ0FBQUgsS0FBQSxVQUdBZixFQUFBLElBQUFnQixFQUNBZCxFQUFBZ0IsSUFBQSxDQUFBSCxLQUFBZixFQUFBLE9BR0FFLEVBQUFnQixJQUFBLENBQUFILEtBQUFDLEVBQUEsV0F2RUEsQ0EyRUFHLFFEaUdBLEdBQUFuRCxTQUFBb0QsU0FBQUMsUUFBQSxXQUNBbEMsUUFBQTVELEdBQUEsaUJBRUEsR0FBQVIsUUFBQUksS0FBQWdFLFFBQUEsU0FBQW1DLEdBRUE5RyxZQUFBLFFBREFxQyxFQUFBLGFBQUF5RSxHQUNBLFdBQUF2RixXQUFBdUYsR0FBQSxPQUdBbEMsRUFBQSxjQUFBRSxNQUFBLENBQUFJLEdBQUEsV0FDQUMsUUFBQUMsSUFBQSx3QkFHQXhFLEtBQUF5QyxpQkFFQSxHQUFBRyxTQUFBb0QsU0FBQUMsUUFBQSxVQUdBN0csWUFBQSw0Q0FGQXdFLE9BQUF6RCxHQUFBLDZCQUVBMkIsY0FDQTFDLFlBQUEsUUFBQXdFLE9BQUE1QyxrQkFFQTRDLE9BQUEsR0FBQWxDIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEFkZCBoYW5kbGVyIHdoZW4gYW4gZXZlbnQgb2NjdXIgdG8gYW4gZWxlbWVudC5cclxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50c1xyXG4gKiBAcGFyYW0ge05vZGV8Tm9kZUxpc3R9IGVsc1xyXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBoYW5kbGVyXHJcbiAqL1xyXG4gZnVuY3Rpb24gYWRkTGlzdGVuZXIoZXZlbnRzLCBlbHMsIGhhbmRsZXIpIHtcclxuICAgIGNvbnN0IGFkZCA9IChldmVudHMsIGVsLCBoYW5kbGVyKSA9PiB7XHJcbiAgICAgICAgZXZlbnRzLnNwbGl0KCcgJykuZm9yRWFjaChldmVudCA9PiBlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChlbHMgaW5zdGFuY2VvZiBOb2RlTGlzdCkge1xyXG4gICAgICAgIFtdLmZvckVhY2guY2FsbChlbHMsIGVsID0+IGFkZChldmVudHMsIGVsLCBoYW5kbGVyKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFkZChldmVudHMsIGVscywgaGFuZGxlcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBCaW5kIEpTT04gdG8gSFRNTC5cclxuICogQHBhcmFtIHtvYmplY3R9IHZhbHVlc1xyXG4gKi9cclxuIGZ1bmN0aW9uIGJpbmQodmFsdWVzKSB7XHJcbiAgICBjb25zdCB0YWdzID0gcWEoJ1tkYXRhLWlkXScpO1xyXG5cclxuICAgIFtdLmZvckVhY2guY2FsbCh0YWdzLCB0YWcgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGFnLmRhdGFzZXRbJ2lkJ107XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaWRdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpZCA9PT0gJ3ByZWNpbycpIHtcclxuICAgICAgICAgICAgdGFnLmlubmVySFRNTCA9IGZvcm1hdEFtb3VudCh2YWx1ZSk7ICAgIFxyXG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICdzYWxkbycpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnZmFsc2UnKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgc2hvd0FkdmljZSh0YWcsIHRydWUpOyB9LCA1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFnLmlubmVySFRNTCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGFtb3VudCB3aXRoIGN1cnJlbmN5IGZvcm1hdC5cclxuICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbiBmdW5jdGlvbiBmb3JtYXRBbW91bnQoYW1vdW50KSB7XHJcbiAgICByZXR1cm4gJyQgJyArIE51bWJlcihhbW91bnQpLnRvRml4ZWQoMikucmVwbGFjZSgvXFxCKD89KFxcZHszfSkrKD8hXFxkKSkvZywgJywnKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBkaWdpdCBrZXl1cCBldmVudC5cclxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldmVudFxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlRGlnaXRLZXl1cCh7dGFyZ2V0LCBrZXlDb2RlfSkge1xyXG4gICAgY29uc3QgcGFyZW50ID0gdGFyZ2V0LnBhcmVudE5vZGU7XHJcbiAgICBcclxuICAgIGlmIChrZXlDb2RlID09PSA4KSB7XHJcbiAgICAgICAgY29uc3QgcHJldiA9IHBhcmVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG5cclxuICAgICAgICBpZiAocHJldikge1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IHEoJ2lucHV0JywgcHJldik7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA+IDQ3ICYmIGtleUNvZGUgPCA1OCkge1xyXG4gICAgICAgIGlmICh0YXJnZXQudmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBwYXJlbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cclxuICAgICAgICAgICAgaWYgKG5leHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gcSgnaW5wdXQnLCBuZXh0KTtcclxuICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGVDb2RlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBcHBseSBudW1iZXIgZmlsdGVyLlxyXG4gKi9cclxuZnVuY3Rpb24gbnVtYmVyRmlsdGVyKGUpIHtcclxuICAgIGNvbnN0IGZpbHRlciA9IC9eXFxkezAsMX0kLztcclxuXHJcbiAgICBpZiAoZmlsdGVyLnRlc3QodGhpcy52YWx1ZSkpIHtcclxuICAgICAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy52YWx1ZTtcclxuICAgICAgICB0aGlzLm9sZFNlbGVjdGlvblN0YXJ0ID0gdGhpcy5zZWxlY3Rpb25TdGFydDtcclxuICAgICAgICB0aGlzLm9sZFNlbGVjdGlvbkVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmhhc093blByb3BlcnR5KCdvbGRWYWx1ZScpKSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMub2xkVmFsdWU7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25SYW5nZSh0aGlzLm9sZFNlbGVjdGlvblN0YXJ0LCB0aGlzLm9sZFNlbGVjdGlvbkVuZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSAnJztcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFBhcnNlIGxvY2F0aW9uLnNlYXJjaCB0byBKU09OLlxyXG4gKiBAcmV0dXJucyBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIHNlYXJjaFRvSnNvbigpIHtcclxuICAgIGNvbnN0IHBhaXJzID0gbG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKS5zcGxpdCgnJicpO1xyXG4gICAgY29uc3Qgb2JqZWN0ID0ge307XHJcbiAgICBsZXQgaSA9IDA7XHJcblxyXG4gICAgZm9yICg7IGkgPCBwYWlycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChwYWlyc1tpXSA9PT0gJycpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHBhaXJzW2ldLnNwbGl0KCc9Jyk7XHJcbiAgICAgICAgb2JqZWN0W2RlY29kZVVSSUNvbXBvbmVudChwYXJ0c1swXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhcnRzWzFdKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gb2JqZWN0O1xyXG59XHJcblxyXG4vKipcclxuICogU2hvdyBvciBoaWRlIGFkdmljZS5cclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWwgXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gZmxhZyBcclxuICovXHJcbmZ1bmN0aW9uIHNob3dBZHZpY2UoZWwsIGZsYWcpIHtcclxuICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnbm8tdmlzaWJsZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCduby12aXNpYmxlJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEbyBxdWVyeVNlbGVjdG9yLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gY29udGV4dFxyXG4gKiBAcmV0dXJucyBOb2RlXHJcbiAqL1xyXG4gZnVuY3Rpb24gcShzZWxlY3RvciwgY29udGV4dCkge1xyXG4gICAgcmV0dXJuIChjb250ZXh0IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERvIHF1ZXJ5U2VsZWN0b3JBbGwuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50W119IGNvbnRleHRcclxuICogQHJldHVybnMgTm9kZUxpc3RcclxuICovXHJcbiBmdW5jdGlvbiBxYShzZWxlY3RvciwgY29udGV4dCkge1xyXG4gICAgcmV0dXJuIChjb250ZXh0IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGNvZGUgZnJvbSBjbGllbnQuXHJcbiAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVDb2RlKCkge1xyXG4gICAgY29uc3QgY29kZUVsID0gcSgnLmF1dGgtc2NyZWVuIC5jb2RlJyk7XHJcbiAgICBjb25zdCBkaWdpdHMgPSBxYSgnLmF1dGgtc2NyZWVuIC5kaWdpdCBpbnB1dCcpO1xyXG4gICAgbGV0IGNvZGUgPSBcIlwiO1xyXG5cclxuICAgIFtdLmZvckVhY2guY2FsbChkaWdpdHMsIGRpZ2l0ID0+IHtcclxuICAgICAgICBjb2RlICs9IGRpZ2l0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGNvZGUubGVuZ3RoID09PSA2KSB7XHJcbiAgICAgICAgaWYgKGNvZGUgPT09ICcwMDAwMDEnKSB7XHJcbiAgICAgICAgICAgIGNvZGVFbC5jbGFzc0xpc3QuYWRkKCd2YWxpZCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvZGVFbC5jbGFzc0xpc3QuYWRkKCdpbnZhbGlkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5pZiAobG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZignZGV0YWlsJykgPj0gMCkge1xyXG4gICAgY29uc3QgYWR2aWNlcyA9IHFhKCcuYWR2aWNlLmZpeGVkJyk7XHJcblxyXG4gICAgW10uZm9yRWFjaC5jYWxsKGFkdmljZXMsIGFkdmljZSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBxKCcuY2xvc2UtYnRuJywgYWR2aWNlKTtcclxuICAgICAgICBhZGRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUJ0biwgKCkgPT4geyBzaG93QWR2aWNlKGFkdmljZSwgZmFsc2UpOyB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJy5zd2lwZS1idG4nKS5zd2lwZSh7Y2I6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzd2lwZSBmcm9tIGRldGFpbCcpO1xyXG4gICAgfX0pO1xyXG5cclxuICAgIGJpbmQoc2VhcmNoVG9Kc29uKCkpO1xyXG5cclxufSBlbHNlIGlmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCdhdXRoJykgPj0gMCkge1xyXG4gICAgY29uc3QgZGlnaXRzID0gcWEoJy5hdXRoLXNjcmVlbiAuZGlnaXQgaW5wdXQnKTtcclxuICAgIFxyXG4gICAgYWRkTGlzdGVuZXIoJ2tleXByZXNzIGtleWRvd24ga2V5dXAgaW5wdXQgY2hhbmdlIHBhc3RlJywgZGlnaXRzLCBudW1iZXJGaWx0ZXIpO1xyXG4gICAgYWRkTGlzdGVuZXIoJ2tleXVwJywgZGlnaXRzLCBoYW5kbGVEaWdpdEtleXVwKTtcclxuXHJcbiAgICBkaWdpdHNbMF0uZm9jdXMoKTtcclxuXHJcbn0gZWxzZSB7XHJcblxyXG59XHJcbiIsIi8vIFJlZmVyZW5jZTogaHR0cHM6Ly9jb2RlcGVuLmlvL2dwcmVzc3V0dG81L3Blbi9OakpvYkc/ZWRpdG9ycz0wMDEwXHJcblxyXG4oZnVuY3Rpb24gKCQpIHtcclxuICAgICQuZm4uc3dpcGUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBzZXR0aW5ncyA9ICQuZXh0ZW5kKHtcclxuICAgICAgICAgICAgY2I6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3N3aXBlIGRvbmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIG9wdGlvbnMpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIGluaXRpYWxNb3VzZSA9IDA7XHJcbiAgICAgICAgICAgIHZhciBzbGlkZU1vdmVtZW50VG90YWwgPSAwO1xyXG4gICAgICAgICAgICB2YXIgbW91c2VJc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyICRzbGlkZXIgPSAkdGhpcy5maW5kKCcuc2xpZGVyJyk7XHJcbiAgICAgICAgICAgIHZhciAkdGV4dCA9ICR0aGlzLmZpbmQoJy50ZXh0Jyk7XHJcblxyXG4gICAgICAgICAgICAkc2xpZGVyLm9uKCdtb3VzZWRvd24gdG91Y2hzdGFydCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgbW91c2VJc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2xpZGVNb3ZlbWVudFRvdGFsID0gJHRoaXMud2lkdGgoKSAtICQodGhpcykud2lkdGgoKSArIDEwO1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhbE1vdXNlID0gZXZlbnQuY2xpZW50WCB8fCBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5LCAkc2xpZGVyKS5vbignbW91c2V1cCB0b3VjaGVuZCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtb3VzZUlzRG93bilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBtb3VzZUlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRNb3VzZSA9IGV2ZW50LmNsaWVudFggfHwgZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVg7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVsYXRpdmVNb3VzZSA9IGN1cnJlbnRNb3VzZSAtIGluaXRpYWxNb3VzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVsYXRpdmVNb3VzZSA8IHNsaWRlTW92ZW1lbnRUb3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICR0ZXh0LmZhZGVUbygzMDAsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzbGlkZXIuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IFwiLTEwcHhcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qICRzbGlkZXIuYWRkQ2xhc3MoJ3VubG9ja2VkJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcjbG9ja2VyJykudGV4dCgnbG9ja19vdXRsaW5lJyk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLm9uKCdjbGljayB0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEkc2xpZGVyLmhhc0NsYXNzKCd1bmxvY2tlZCcpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLnJlbW92ZUNsYXNzKCd1bmxvY2tlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjbG9ja2VyJykudGV4dCgnbG9ja19vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzbGlkZXIub2ZmKCdjbGljayB0YXAnKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sIDApOyAqL1xyXG5cclxuICAgICAgICAgICAgICAgIHNldHRpbmdzLmNiKCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLm9uKCdtb3VzZW1vdmUgdG91Y2htb3ZlJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW1vdXNlSXNEb3duKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE1vdXNlID0gZXZlbnQuY2xpZW50WCB8fCBldmVudC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVsYXRpdmVNb3VzZSA9IGN1cnJlbnRNb3VzZSAtIGluaXRpYWxNb3VzZTtcclxuICAgICAgICAgICAgICAgIHZhciBzbGlkZVBlcmNlbnQgPSAxIC0gKHJlbGF0aXZlTW91c2UgLyBzbGlkZU1vdmVtZW50VG90YWwpO1xyXG5cclxuICAgICAgICAgICAgICAgICR0ZXh0LmZhZGVUbygwLCBzbGlkZVBlcmNlbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGl2ZU1vdXNlIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLmNzcyh7ICdsZWZ0JzogJy0xMHB4JyB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocmVsYXRpdmVNb3VzZSA+PSBzbGlkZU1vdmVtZW50VG90YWwgKyAxMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzbGlkZXIuY3NzKHsgJ2xlZnQnOiBzbGlkZU1vdmVtZW50VG90YWwgKyAncHgnIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICRzbGlkZXIuY3NzKHsgJ2xlZnQnOiByZWxhdGl2ZU1vdXNlIC0gMTAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59KShqUXVlcnkpO1xyXG4iXX0=

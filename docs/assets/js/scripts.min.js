"use strict";function addListener(t,e,n){function i(e,t,n){e.split(" ").forEach(function(e){return t.addEventListener(e,n)})}e instanceof NodeList?[].forEach.call(e,function(e){return i(t,e,n)}):i(t,e,n)}function bind(i){var e=qa("[data-id]");[].forEach.call(e,function(e){var t=e.dataset.id,n=i[t];"precio"===t?e.innerHTML=formatAmount(n):"saldo"===t?"false"===n&&setTimeout(function(){showAdvice(e,!0)},500):e.innerHTML=n})}function formatAmount(e){return"$ "+Number(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}function handleDigitKeyup(e){var t=e.target,n=e.keyCode,i=t.parentNode;8===n?(e=i.previousElementSibling)&&((e=q("input",e)).value="",e.focus()):47<n&&n<58&&(""===t.value||(i=i.nextElementSibling)&&q("input",i).focus()),validateCode()}function numberFilter(e){/^\d{0,1}$/.test(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""}function q(e,t){return(t||document).querySelector(e)}function qa(e,t){return(t||document).querySelectorAll(e)}function request(e,t,n,i,o){$.ajax({url:"https://omm6oug5pg.execute-api.us-east-1.amazonaws.com/desarrollo/oauth2/v1/token",method:"POST",body:{grant_type:"client_credentials"},beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa("18h8vanvrh4pui1lrntc1niljf:1ge31bhjrdk9d0ja14mft8qepi4clkt805jqb2svqvmb4so1v4g7"))},success:function(){console.log(arguments)}})}function searchToJson(){for(var e,t=location.search.substring(1).split("&"),n={},i=0;i<t.length;i++)""!==t[i]&&(e=t[i].split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return n}function showAdvice(e,t){t?e.classList.remove("no-visible"):e.classList.add("no-visible")}function validateCode(){var e=q(".auth-screen .code"),t=qa(".auth-screen .digit input"),n="";[].forEach.call(t,function(e){n+=e.value}),6===n.length&&("000001"===n?e.classList.add("valid"):e.classList.add("invalid"))}var advices,digits;!function(d){d.fn.swipe=function(e){var c=d.extend({cb:function(){console.log("swipe done")}},e);return this.each(function(){var t=d(this),n=0,i=0,o=!1,a=t.find(".slider"),s=t.find(".text");a.on("mousedown touchstart",function(e){o=!0,i=t.width()-d(this).width()+10,n=e.clientX||e.originalEvent.touches[0].pageX}),d(document.body,a).on("mouseup touchend",function(e){if(o){if(o=!1,(e.clientX||e.changedTouches[0].pageX)-n<i)return s.fadeTo(300,1),void a.animate({left:"-10px"},300);c.cb()}}),d(document.body).on("mousemove touchmove",function(e){var t;o&&(e=1-(t=(e.clientX||e.originalEvent.touches[0].pageX)-n)/i,s.fadeTo(0,e),t<=0?a.css({left:"-10px"}):i+10<=t?a.css({left:i+"px"}):a.css({left:t-10}))})})}}(jQuery),0<=location.pathname.indexOf("detail")?(advices=qa(".advice.fixed"),[].forEach.call(advices,function(e){addListener("click",q(".close-btn",e),function(){showAdvice(e,!1)})}),$(".swipe-btn").swipe({cb:function(){console.log("swipe from detail")}}),bind(searchToJson())):0<=location.pathname.indexOf("auth")&&(addListener("keypress keydown keyup input change paste",digits=qa(".auth-screen .digit input"),numberFilter),addListener("keyup",digits,handleDigitKeyup),digits[0].focus());
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiLCJqcXVlcnkuc3dpcGUuanMiXSwibmFtZXMiOlsiYWRkTGlzdGVuZXIiLCJldmVudHMiLCJlbHMiLCJoYW5kbGVyIiwiYWRkIiwiZWwiLCJzcGxpdCIsImZvckVhY2giLCJldmVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJOb2RlTGlzdCIsImNhbGwiLCJiaW5kIiwidmFsdWVzIiwidGFncyIsInFhIiwidGFnIiwiaWQiLCJkYXRhc2V0IiwidmFsdWUiLCJpbm5lckhUTUwiLCJmb3JtYXRBbW91bnQiLCJzZXRUaW1lb3V0Iiwic2hvd0FkdmljZSIsImFtb3VudCIsIk51bWJlciIsInRvRml4ZWQiLCJyZXBsYWNlIiwiaGFuZGxlRGlnaXRLZXl1cCIsIl9yZWYiLCJ0YXJnZXQiLCJrZXlDb2RlIiwicGFyZW50IiwicGFyZW50Tm9kZSIsInByZXYiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiaW5wdXQiLCJxIiwiZm9jdXMiLCJuZXh0IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidmFsaWRhdGVDb2RlIiwibnVtYmVyRmlsdGVyIiwiZSIsInRlc3QiLCJ0aGlzIiwib2xkVmFsdWUiLCJvbGRTZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvblN0YXJ0Iiwib2xkU2VsZWN0aW9uRW5kIiwic2VsZWN0aW9uRW5kIiwiaGFzT3duUHJvcGVydHkiLCJzZXRTZWxlY3Rpb25SYW5nZSIsInNlbGVjdG9yIiwiY29udGV4dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZXF1ZXN0IiwidXJsIiwibWV0aG9kIiwiYm9keSIsImhlYWRlcnMiLCJjYWxsYmFjayIsIiQiLCJhamF4IiwiZ3JhbnRfdHlwZSIsImJlZm9yZVNlbmQiLCJqcVhIUiIsInNldFJlcXVlc3RIZWFkZXIiLCJidG9hIiwic3VjY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJhcmd1bWVudHMiLCJzZWFyY2hUb0pzb24iLCJwYXJ0cyIsInBhaXJzIiwibG9jYXRpb24iLCJzZWFyY2giLCJzdWJzdHJpbmciLCJvYmplY3QiLCJpIiwibGVuZ3RoIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZmxhZyIsImNsYXNzTGlzdCIsInJlbW92ZSIsImNvZGVFbCIsImRpZ2l0cyIsImNvZGUiLCJkaWdpdCIsImFkdmljZXMiLCJmbiIsInN3aXBlIiwib3B0aW9ucyIsInNldHRpbmdzIiwiZXh0ZW5kIiwiY2IiLCJlYWNoIiwiJHRoaXMiLCJpbml0aWFsTW91c2UiLCJzbGlkZU1vdmVtZW50VG90YWwiLCJtb3VzZUlzRG93biIsIiRzbGlkZXIiLCJmaW5kIiwiJHRleHQiLCJvbiIsIndpZHRoIiwiY2xpZW50WCIsIm9yaWdpbmFsRXZlbnQiLCJ0b3VjaGVzIiwicGFnZVgiLCJjaGFuZ2VkVG91Y2hlcyIsImZhZGVUbyIsImFuaW1hdGUiLCJsZWZ0IiwicmVsYXRpdmVNb3VzZSIsInNsaWRlUGVyY2VudCIsImNzcyIsImpRdWVyeSIsInBhdGhuYW1lIiwiaW5kZXhPZiIsImFkdmljZSJdLCJtYXBwaW5ncyI6ImFBTUEsU0FBQUEsWUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxTQUFBQyxFQUFBSCxFQUFBSSxFQUFBRixHQUNBRixFQUFBSyxNQUFBLEtBQUFDLFFBQUEsU0FBQUMsR0FBQSxPQUFBSCxFQUFBSSxpQkFBQUQsRUFBQUwsS0FHQUQsYUFBQVEsU0FDQSxHQUFBSCxRQUFBSSxLQUFBVCxFQUFBLFNBQUFHLEdBQUEsT0FBQUQsRUFBQUgsRUFBQUksRUFBQUYsS0FFQUMsRUFBQUgsRUFBQUMsRUFBQUMsR0FRQSxTQUFBUyxLQUFBQyxHQUNBLElBQUFDLEVBQUFDLEdBQUEsYUFFQSxHQUFBUixRQUFBSSxLQUFBRyxFQUFBLFNBQUFFLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsUUFBQSxHQUNBQyxFQUFBTixFQUFBSSxHQUVBLFdBQUFBLEVBQ0FELEVBQUFJLFVBQUFDLGFBQUFGLEdBQ0EsVUFBQUYsRUFDQSxVQUFBRSxHQUNBRyxXQUFBLFdBQUFDLFdBQUFQLEdBQUEsSUFBQSxLQUdBQSxFQUFBSSxVQUFBRCxJQVVBLFNBQUFFLGFBQUFHLEdBQ0EsTUFBQSxLQUFBQyxPQUFBRCxHQUFBRSxRQUFBLEdBQUFDLFFBQUEsd0JBQUEsS0FPQSxTQUFBQyxpQkFBQUMsR0FBQSxJQUFBQyxFQUFBRCxFQUFBQyxPQUFBQyxFQUFBRixFQUFBRSxRQUNBQyxFQUFBRixFQUFBRyxXQUVBLElBQUFGLEdBQ0FHLEVBQUFGLEVBQUFHLDJCQUdBQyxFQUFBQyxFQUFBLFFBQUFILElBQ0FmLE1BQUEsR0FDQWlCLEVBQUFFLFNBR0EsR0FBQVAsR0FBQUEsRUFBQSxLQUNBLEtBQUFELEVBQUFYLFFBQ0FvQixFQUFBUCxFQUFBUSxxQkFHQUgsRUFBQSxRQUFBRSxHQUNBRCxTQUtBRyxlQU9BLFNBQUFDLGFBQUFDLEdBQ0EsWUFFQUMsS0FBQUMsS0FBQTFCLFFBQ0EwQixLQUFBQyxTQUFBRCxLQUFBMUIsTUFDQTBCLEtBQUFFLGtCQUFBRixLQUFBRyxlQUNBSCxLQUFBSSxnQkFBQUosS0FBQUssY0FDQUwsS0FBQU0sZUFBQSxhQUNBTixLQUFBMUIsTUFBQTBCLEtBQUFDLFNBQ0FELEtBQUFPLGtCQUFBUCxLQUFBRSxrQkFBQUYsS0FBQUksa0JBRUFKLEtBQUExQixNQUFBLEdBVUEsU0FBQWtCLEVBQUFnQixFQUFBQyxHQUNBLE9BQUFBLEdBQUFDLFVBQUFDLGNBQUFILEdBU0EsU0FBQXRDLEdBQUFzQyxFQUFBQyxHQUNBLE9BQUFBLEdBQUFDLFVBQUFFLGlCQUFBSixHQVdBLFNBQUFLLFFBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLEVBQUFDLEtBQUEsQ0FDQU4sSUFBQSxvRkFDQUMsT0FBQSxPQUNBQyxLQUFBLENBQUFLLFdBQUEsc0JBQ0FDLFdBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQUEsZ0JBQUEsU0FBQUMsS0FBQSxxRkFFQUMsUUFBQSxXQUNBQyxRQUFBQyxJQUFBQyxjQVNBLFNBQUFDLGVBS0EsSUFKQSxJQVNBQyxFQVRBQyxFQUFBQyxTQUFBQyxPQUFBQyxVQUFBLEdBQUExRSxNQUFBLEtBQ0EyRSxFQUFBLEdBQ0FDLEVBQUEsRUFFQUEsRUFBQUwsRUFBQU0sT0FBQUQsSUFDQSxLQUFBTCxFQUFBSyxLQUlBTixFQUFBQyxFQUFBSyxHQUFBNUUsTUFBQSxLQUNBMkUsRUFBQUcsbUJBQUFSLEVBQUEsS0FBQVEsbUJBQUFSLEVBQUEsS0FHQSxPQUFBSyxFQVFBLFNBQUExRCxXQUFBbEIsRUFBQWdGLEdBQ0FBLEVBQ0FoRixFQUFBaUYsVUFBQUMsT0FBQSxjQUVBbEYsRUFBQWlGLFVBQUFsRixJQUFBLGNBUUEsU0FBQXFDLGVBQ0EsSUFBQStDLEVBQUFuRCxFQUFBLHNCQUNBb0QsRUFBQTFFLEdBQUEsNkJBQ0EyRSxFQUFBLEdBRUEsR0FBQW5GLFFBQUFJLEtBQUE4RSxFQUFBLFNBQUFFLEdBQ0FELEdBQUFDLEVBQUF4RSxRQUdBLElBQUF1RSxFQUFBUCxTQUNBLFdBQUFPLEVBQ0FGLEVBQUFGLFVBQUFsRixJQUFBLFNBRUFvRixFQUFBRixVQUFBbEYsSUFBQSxZQUtBLElBQ0F3RixRQWdCQUgsUUNwTkEsU0FBQXpCLEdBQ0FBLEVBQUE2QixHQUFBQyxNQUFBLFNBQUFDLEdBQ0EsSUFBQUMsRUFBQWhDLEVBQUFpQyxPQUFBLENBQ0FDLEdBQUEsV0FDQTFCLFFBQUFDLElBQUEsZ0JBRUFzQixHQUVBLE9BQUFsRCxLQUFBc0QsS0FBQSxXQUNBLElBQUFDLEVBQUFwQyxFQUFBbkIsTUFDQXdELEVBQUEsRUFDQUMsRUFBQSxFQUNBQyxHQUFBLEVBQ0FDLEVBQUFKLEVBQUFLLEtBQUEsV0FDQUMsRUFBQU4sRUFBQUssS0FBQSxTQUVBRCxFQUFBRyxHQUFBLHVCQUFBLFNBQUFuRyxHQUNBK0YsR0FBQSxFQUNBRCxFQUFBRixFQUFBUSxRQUFBNUMsRUFBQW5CLE1BQUErRCxRQUFBLEdBQ0FQLEVBQUE3RixFQUFBcUcsU0FBQXJHLEVBQUFzRyxjQUFBQyxRQUFBLEdBQUFDLFFBR0FoRCxFQUFBVCxTQUFBTSxLQUFBMkMsR0FBQUcsR0FBQSxtQkFBQSxTQUFBbkcsR0FDQSxHQUFBK0YsRUFBQSxDQU1BLEdBSkFBLEdBQUEsR0FDQS9GLEVBQUFxRyxTQUFBckcsRUFBQXlHLGVBQUEsR0FBQUQsT0FDQVgsRUFFQUMsRUFLQSxPQUpBSSxFQUFBUSxPQUFBLElBQUEsUUFDQVYsRUFBQVcsUUFBQSxDQUNBQyxLQUFBLFNBQ0EsS0FnQkFwQixFQUFBRSxRQUlBbEMsRUFBQVQsU0FBQU0sTUFBQThDLEdBQUEsc0JBQUEsU0FBQW5HLEdBQ0EsSUFJQTZHLEVBSkFkLElBS0FlLEVBQUEsR0FEQUQsR0FEQTdHLEVBQUFxRyxTQUFBckcsRUFBQXNHLGNBQUFDLFFBQUEsR0FBQUMsT0FDQVgsR0FDQUMsRUFFQUksRUFBQVEsT0FBQSxFQUFBSSxHQUVBRCxHQUFBLEVBQ0FiLEVBQUFlLElBQUEsQ0FBQUgsS0FBQSxVQUdBZCxFQUFBLElBQUFlLEVBQ0FiLEVBQUFlLElBQUEsQ0FBQUgsS0FBQWQsRUFBQSxPQUdBRSxFQUFBZSxJQUFBLENBQUFILEtBQUFDLEVBQUEsV0F2RUEsQ0EyRUFHLFFEd0hBLEdBQUExQyxTQUFBMkMsU0FBQUMsUUFBQSxXQUNBOUIsUUFBQTdFLEdBQUEsaUJBRUEsR0FBQVIsUUFBQUksS0FBQWlGLFFBQUEsU0FBQStCLEdBRUEzSCxZQUFBLFFBREFxQyxFQUFBLGFBQUFzRixHQUNBLFdBQUFwRyxXQUFBb0csR0FBQSxPQUdBM0QsRUFBQSxjQUFBOEIsTUFBQSxDQUNBSSxHQUFBLFdBQ0ExQixRQUFBQyxJQUFBLHdCQUlBN0QsS0FBQStELGlCQUVBLEdBQUFHLFNBQUEyQyxTQUFBQyxRQUFBLFVBR0ExSCxZQUFBLDRDQUZBeUYsT0FBQTFFLEdBQUEsNkJBRUEyQixjQUNBMUMsWUFBQSxRQUFBeUYsT0FBQTdELGtCQUVBNkQsT0FBQSxHQUFBbkQiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQWRkIGhhbmRsZXIgd2hlbiBhbiBldmVudCBvY2N1ciB0byBhbiBlbGVtZW50LlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRzXHJcbiAqIEBwYXJhbSB7Tm9kZXxOb2RlTGlzdH0gZWxzXHJcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGhhbmRsZXJcclxuICovXHJcbmZ1bmN0aW9uIGFkZExpc3RlbmVyKGV2ZW50cywgZWxzLCBoYW5kbGVyKSB7XHJcbiAgICBjb25zdCBhZGQgPSAoZXZlbnRzLCBlbCwgaGFuZGxlcikgPT4ge1xyXG4gICAgICAgIGV2ZW50cy5zcGxpdCgnICcpLmZvckVhY2goZXZlbnQgPT4gZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcikpO1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoZWxzIGluc3RhbmNlb2YgTm9kZUxpc3QpIHtcclxuICAgICAgICBbXS5mb3JFYWNoLmNhbGwoZWxzLCBlbCA9PiBhZGQoZXZlbnRzLCBlbCwgaGFuZGxlcikpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBhZGQoZXZlbnRzLCBlbHMsIGhhbmRsZXIpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogQmluZCBKU09OIHRvIEhUTUwuXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSB2YWx1ZXNcclxuICovXHJcbmZ1bmN0aW9uIGJpbmQodmFsdWVzKSB7XHJcbiAgICBjb25zdCB0YWdzID0gcWEoJ1tkYXRhLWlkXScpO1xyXG5cclxuICAgIFtdLmZvckVhY2guY2FsbCh0YWdzLCB0YWcgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGFnLmRhdGFzZXRbJ2lkJ107XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaWRdO1xyXG5cclxuICAgICAgICBpZiAoaWQgPT09ICdwcmVjaW8nKSB7XHJcbiAgICAgICAgICAgIHRhZy5pbm5lckhUTUwgPSBmb3JtYXRBbW91bnQodmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICdzYWxkbycpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnZmFsc2UnKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgc2hvd0FkdmljZSh0YWcsIHRydWUpOyB9LCA1MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFnLmlubmVySFRNTCA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGFtb3VudCB3aXRoIGN1cnJlbmN5IGZvcm1hdC5cclxuICogQHBhcmFtIHtudW1iZXJ9IGFtb3VudCBcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbmZ1bmN0aW9uIGZvcm1hdEFtb3VudChhbW91bnQpIHtcclxuICAgIHJldHVybiAnJCAnICsgTnVtYmVyKGFtb3VudCkudG9GaXhlZCgyKS5yZXBsYWNlKC9cXEIoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCAnLCcpO1xyXG59XHJcblxyXG4vKipcclxuICogSGFuZGxlIGRpZ2l0IGtleXVwIGV2ZW50LlxyXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50XHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVEaWdpdEtleXVwKHsgdGFyZ2V0LCBrZXlDb2RlIH0pIHtcclxuICAgIGNvbnN0IHBhcmVudCA9IHRhcmdldC5wYXJlbnROb2RlO1xyXG5cclxuICAgIGlmIChrZXlDb2RlID09PSA4KSB7XHJcbiAgICAgICAgY29uc3QgcHJldiA9IHBhcmVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG5cclxuICAgICAgICBpZiAocHJldikge1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IHEoJ2lucHV0JywgcHJldik7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA+IDQ3ICYmIGtleUNvZGUgPCA1OCkge1xyXG4gICAgICAgIGlmICh0YXJnZXQudmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBwYXJlbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cclxuICAgICAgICAgICAgaWYgKG5leHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gcSgnaW5wdXQnLCBuZXh0KTtcclxuICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGVDb2RlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBcHBseSBudW1iZXIgZmlsdGVyLlxyXG4gKiBAcGFyYW0ge0V2ZW50fSBlXHJcbiAqL1xyXG5mdW5jdGlvbiBudW1iZXJGaWx0ZXIoZSkge1xyXG4gICAgY29uc3QgZmlsdGVyID0gL15cXGR7MCwxfSQvO1xyXG5cclxuICAgIGlmIChmaWx0ZXIudGVzdCh0aGlzLnZhbHVlKSkge1xyXG4gICAgICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgIHRoaXMub2xkU2VsZWN0aW9uU3RhcnQgPSB0aGlzLnNlbGVjdGlvblN0YXJ0O1xyXG4gICAgICAgIHRoaXMub2xkU2VsZWN0aW9uRW5kID0gdGhpcy5zZWxlY3Rpb25FbmQ7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoJ29sZFZhbHVlJykpIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5vbGRWYWx1ZTtcclxuICAgICAgICB0aGlzLnNldFNlbGVjdGlvblJhbmdlKHRoaXMub2xkU2VsZWN0aW9uU3RhcnQsIHRoaXMub2xkU2VsZWN0aW9uRW5kKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogRG8gcXVlcnlTZWxlY3Rvci5cclxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGNvbnRleHRcclxuICogQHJldHVybnMgTm9kZVxyXG4gKi9cclxuIGZ1bmN0aW9uIHEoc2VsZWN0b3IsIGNvbnRleHQpIHtcclxuICAgIHJldHVybiAoY29udGV4dCB8fCBkb2N1bWVudCkucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEbyBxdWVyeVNlbGVjdG9yQWxsLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBjb250ZXh0XHJcbiAqIEByZXR1cm5zIE5vZGVMaXN0XHJcbiAqL1xyXG5mdW5jdGlvbiBxYShzZWxlY3RvciwgY29udGV4dCkge1xyXG4gICAgcmV0dXJuIChjb250ZXh0IHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE1ha2UgcmVxdWVzdC5cclxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBcclxuICogQHBhcmFtIHtzdHJpbmd9IG1ldGhvZFxyXG4gKiBAcGFyYW0ge29iamVjdH0gYm9keVxyXG4gKiBAcGFyYW0ge29iamVjdH0gaGVhZGVycyBcclxuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgXHJcbiAqL1xyXG5mdW5jdGlvbiByZXF1ZXN0KHVybCwgbWV0aG9kLCBib2R5LCBoZWFkZXJzLCBjYWxsYmFjaykge1xyXG4gICAgJC5hamF4KHtcclxuICAgICAgICB1cmw6ICdodHRwczovL29tbTZvdWc1cGcuZXhlY3V0ZS1hcGkudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vZGVzYXJyb2xsby9vYXV0aDIvdjEvdG9rZW4nLFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGJvZHk6IHsgJ2dyYW50X3R5cGUnOiAnY2xpZW50X2NyZWRlbnRpYWxzJyB9LFxyXG4gICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKGpxWEhSKSB7XHJcbiAgICAgICAgICAgIGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCBcIkJhc2ljIFwiICsgYnRvYSgnMThoOHZhbnZyaDRwdWkxbHJudGMxbmlsamYnICsgXCI6XCIgKyAnMWdlMzFiaGpyZGs5ZDBqYTE0bWZ0OHFlcGk0Y2xrdDgwNWpxYjJzdnF2bWI0c28xdjRnNycpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhcmd1bWVudHMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgbG9jYXRpb24uc2VhcmNoIHRvIEpTT04uXHJcbiAqIEByZXR1cm5zIG9iamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gc2VhcmNoVG9Kc29uKCkge1xyXG4gICAgY29uc3QgcGFpcnMgPSBsb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLnNwbGl0KCcmJyk7XHJcbiAgICBjb25zdCBvYmplY3QgPSB7fTtcclxuICAgIGxldCBpID0gMDtcclxuXHJcbiAgICBmb3IgKDsgaSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHBhaXJzW2ldID09PSAnJykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gcGFpcnNbaV0uc3BsaXQoJz0nKTtcclxuICAgICAgICBvYmplY3RbZGVjb2RlVVJJQ29tcG9uZW50KHBhcnRzWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFydHNbMV0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBvYmplY3Q7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTaG93IG9yIGhpZGUgYWR2aWNlLlxyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbCBcclxuICogQHBhcmFtIHtib29sZWFufSBmbGFnIFxyXG4gKi9cclxuZnVuY3Rpb24gc2hvd0FkdmljZShlbCwgZmxhZykge1xyXG4gICAgaWYgKGZsYWcpIHtcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCduby12aXNpYmxlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ25vLXZpc2libGUnKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGNvZGUgZnJvbSBjbGllbnQuXHJcbiAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVDb2RlKCkge1xyXG4gICAgY29uc3QgY29kZUVsID0gcSgnLmF1dGgtc2NyZWVuIC5jb2RlJyk7XHJcbiAgICBjb25zdCBkaWdpdHMgPSBxYSgnLmF1dGgtc2NyZWVuIC5kaWdpdCBpbnB1dCcpO1xyXG4gICAgbGV0IGNvZGUgPSBcIlwiO1xyXG5cclxuICAgIFtdLmZvckVhY2guY2FsbChkaWdpdHMsIGRpZ2l0ID0+IHtcclxuICAgICAgICBjb2RlICs9IGRpZ2l0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGNvZGUubGVuZ3RoID09PSA2KSB7XHJcbiAgICAgICAgaWYgKGNvZGUgPT09ICcwMDAwMDEnKSB7XHJcbiAgICAgICAgICAgIGNvZGVFbC5jbGFzc0xpc3QuYWRkKCd2YWxpZCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvZGVFbC5jbGFzc0xpc3QuYWRkKCdpbnZhbGlkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5pZiAobG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZignZGV0YWlsJykgPj0gMCkge1xyXG4gICAgY29uc3QgYWR2aWNlcyA9IHFhKCcuYWR2aWNlLmZpeGVkJyk7XHJcblxyXG4gICAgW10uZm9yRWFjaC5jYWxsKGFkdmljZXMsIGFkdmljZSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBxKCcuY2xvc2UtYnRuJywgYWR2aWNlKTtcclxuICAgICAgICBhZGRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUJ0biwgKCkgPT4geyBzaG93QWR2aWNlKGFkdmljZSwgZmFsc2UpOyB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJy5zd2lwZS1idG4nKS5zd2lwZSh7XHJcbiAgICAgICAgY2I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3N3aXBlIGZyb20gZGV0YWlsJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgYmluZChzZWFyY2hUb0pzb24oKSk7XHJcblxyXG59IGVsc2UgaWYgKGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoJ2F1dGgnKSA+PSAwKSB7XHJcbiAgICBjb25zdCBkaWdpdHMgPSBxYSgnLmF1dGgtc2NyZWVuIC5kaWdpdCBpbnB1dCcpO1xyXG5cclxuICAgIGFkZExpc3RlbmVyKCdrZXlwcmVzcyBrZXlkb3duIGtleXVwIGlucHV0IGNoYW5nZSBwYXN0ZScsIGRpZ2l0cywgbnVtYmVyRmlsdGVyKTtcclxuICAgIGFkZExpc3RlbmVyKCdrZXl1cCcsIGRpZ2l0cywgaGFuZGxlRGlnaXRLZXl1cCk7XHJcblxyXG4gICAgZGlnaXRzWzBdLmZvY3VzKCk7XHJcblxyXG59IGVsc2Uge1xyXG5cclxufVxyXG4iLCIvLyBSZWZlcmVuY2U6IGh0dHBzOi8vY29kZXBlbi5pby9ncHJlc3N1dHRvNS9wZW4vTmpKb2JHP2VkaXRvcnM9MDAxMFxyXG5cclxuKGZ1bmN0aW9uICgkKSB7XHJcbiAgICAkLmZuLnN3aXBlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgc2V0dGluZ3MgPSAkLmV4dGVuZCh7XHJcbiAgICAgICAgICAgIGNiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzd2lwZSBkb25lJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgIHZhciBpbml0aWFsTW91c2UgPSAwO1xyXG4gICAgICAgICAgICB2YXIgc2xpZGVNb3ZlbWVudFRvdGFsID0gMDtcclxuICAgICAgICAgICAgdmFyIG1vdXNlSXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciAkc2xpZGVyID0gJHRoaXMuZmluZCgnLnNsaWRlcicpO1xyXG4gICAgICAgICAgICB2YXIgJHRleHQgPSAkdGhpcy5maW5kKCcudGV4dCcpO1xyXG5cclxuICAgICAgICAgICAgJHNsaWRlci5vbignbW91c2Vkb3duIHRvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIG1vdXNlSXNEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNsaWRlTW92ZW1lbnRUb3RhbCA9ICR0aGlzLndpZHRoKCkgLSAkKHRoaXMpLndpZHRoKCkgKyAxMDtcclxuICAgICAgICAgICAgICAgIGluaXRpYWxNb3VzZSA9IGV2ZW50LmNsaWVudFggfHwgZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQuYm9keSwgJHNsaWRlcikub24oJ21vdXNldXAgdG91Y2hlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghbW91c2VJc0Rvd24pXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgbW91c2VJc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TW91c2UgPSBldmVudC5jbGllbnRYIHx8IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlbGF0aXZlTW91c2UgPSBjdXJyZW50TW91c2UgLSBpbml0aWFsTW91c2U7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHJlbGF0aXZlTW91c2UgPCBzbGlkZU1vdmVtZW50VG90YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdGV4dC5mYWRlVG8oMzAwLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBcIi0xMHB4XCJcclxuICAgICAgICAgICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvKiAkc2xpZGVyLmFkZENsYXNzKCd1bmxvY2tlZCcpO1xyXG4gICAgICAgICAgICAgICAgJCgnI2xvY2tlcicpLnRleHQoJ2xvY2tfb3V0bGluZScpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlci5vbignY2xpY2sgdGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNsaWRlci5oYXNDbGFzcygndW5sb2NrZWQnKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNsaWRlci5yZW1vdmVDbGFzcygndW5sb2NrZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2xvY2tlcicpLnRleHQoJ2xvY2tfb3BlbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLm9mZignY2xpY2sgdGFwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTsgKi9cclxuXHJcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5jYigpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJChkb2N1bWVudC5ib2R5KS5vbignbW91c2Vtb3ZlIHRvdWNobW92ZScsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtb3VzZUlzRG93bilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRNb3VzZSA9IGV2ZW50LmNsaWVudFggfHwgZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlbGF0aXZlTW91c2UgPSBjdXJyZW50TW91c2UgLSBpbml0aWFsTW91c2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVQZXJjZW50ID0gMSAtIChyZWxhdGl2ZU1vdXNlIC8gc2xpZGVNb3ZlbWVudFRvdGFsKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkdGV4dC5mYWRlVG8oMCwgc2xpZGVQZXJjZW50KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVsYXRpdmVNb3VzZSA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlci5jc3MoeyAnbGVmdCc6ICctMTBweCcgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHJlbGF0aXZlTW91c2UgPj0gc2xpZGVNb3ZlbWVudFRvdGFsICsgMTApIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2xpZGVyLmNzcyh7ICdsZWZ0Jzogc2xpZGVNb3ZlbWVudFRvdGFsICsgJ3B4JyB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2xpZGVyLmNzcyh7ICdsZWZ0JzogcmVsYXRpdmVNb3VzZSAtIDEwIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkoalF1ZXJ5KTtcclxuIl19
